# ğŸ“… Gerador de Planilha AutomÃ¡tico criado para o CacaoLab
Uma ferramenta em Python eficiente e flexÃ­vel para gerar cronogramas de reuniÃµes, escalas de trabalho ou apresentaÃ§Ãµes (como *Journal Clubs* e *Lab Meetings*). O script automatiza a distribuiÃ§Ã£o de datas, respeita feriados e garante um sorteio justo entre os participantes.

## ğŸš€ Funcionalidades

* **Sorteio Justo (Fair Shuffle):** Garante que todos os participantes sejam escalados uma vez antes de qualquer repetiÃ§Ã£o.
* **GestÃ£o de Feriados:** IntegraÃ§Ã£o com a biblioteca `holidays` para identificar feriados brasileiros (nacionais e estaduais). OpÃ§Ã£o de pular o dia ou marcar como "Feriado" na planilha.
* **SeleÃ§Ã£o de Dias da Semana:** ConfigurÃ¡vel para gerar escalas em dias especÃ­ficos (ex: apenas Segundas e Quintas).
* **Intervalo de Datas DinÃ¢mico:** Aceita datas de inÃ­cio (hoje ou futuro) e fim personalizadas.
* **ExportaÃ§Ã£o:** Gera a saÃ­da em um DataFrame do Pandas, pronto para exportaÃ§Ã£o (CSV/Excel).

## ğŸ› ï¸ PrÃ©-requisitos

Para executar este projeto, vocÃª precisarÃ¡ ter o Python instalado e as seguintes bibliotecas:

* [pandas](https://pandas.pydata.org/)
* [holidays](https://pypi.org/project/holidays/)

### InstalaÃ§Ã£o

Execute o comando abaixo no terminal para instalar as dependÃªncias:

```bash
pip install pandas holidays
````
---

## ğŸ“– Como Usar

Salve o cÃ³digo da funÃ§Ã£o principal em um arquivo (por exemplo, `gerador_escala.py`). Abaixo estÃ¡ um exemplo de como importar e utilizar a funÃ§Ã£o.

```python
from gerador_escala import gerar_escala
from datetime import date

# 1. Defina o intervalo de datas
inicio = date.today()
fim = date(2025, 12, 31)

# 2. Defina os dias da semana (1=Segunda, 7=Domingo)
# Exemplo: Segundas (1) e Quintas (4)
dias_desejados = [1, 4]

# 3. (Opcional) Defina sua lista de pessoas
# Se nÃ£o passar nada, usarÃ¡ a lista padrÃ£o configurada no script
minha_equipe = ["Ana", "Bruno", "Carlos", "Daniela"]

# 4. Gere a escala
df = gerar_escala(
    data_inicio=inicio, 
    data_fim=fim, 
    dias_semana=dias_desejados,
    pessoas=minha_equipe,
    pular_feriados=False, # Se False, o feriado aparece na lista. Se True, a linha Ã© pulada.
    estado_feriado="SP"
)

# 5. Visualize ou Exporte
print(df.head())

# Exportando para CSV (compatÃ­vel com Excel)
df.to_csv("Minha_Escala.csv", index=False, encoding='utf-8-sig')
```
---

## âš™ï¸ ParÃ¢metros da FunÃ§Ã£o

A funÃ§Ã£o `gerar_escala` aceita os seguintes argumentos:

| ParÃ¢metro | Tipo | DescriÃ§Ã£o | PadrÃ£o |
| :--- | :--- | :--- | :--- |
| `data_inicio` | `date` ou `str` | Data inicial da escala. | **ObrigatÃ³rio** |
| `data_fim` | `date` ou `str` | Data limite da escala. | **ObrigatÃ³rio** |
| `dias_semana` | `list[int]` | Dias da semana a ocupar (1=Seg, 7=Dom). | **ObrigatÃ³rio** |
| `pessoas` | `list[str]` | Lista de nomes para sorteio. | `None` (Usa padrÃ£o) |
| `pular_feriados` | `bool` | Se `True`, nÃ£o agenda nada no dia. Se `False`, marca como "Feriado". | `True` |
| `estado_feriado` | `str` | Sigla do estado para feriados regionais. | `"SP"` |

---

## ğŸ“„ Exemplo de SaÃ­da (CSV)

O arquivo gerado terÃ¡ o seguinte formato:

| Data | Dia da Semana | Pessoa | Tipo |
| :--- | :--- | :--- | :--- |
| 10/06 | Segunda-feira | Bruno | Lab meeting |
| 13/06 | Quinta-feira | Ana | Journal Club |
| 17/06 | Segunda-feira | Daniela | Lab meeting |
| 20/06 | Quinta-feira | FERIADO | Corpus Christi |
| 24/06 | Segunda-feira | Carlos | Journal Club |

---

## ğŸ“ LicenÃ§a
Este projeto Ã© de uso livre. Sinta-se Ã  vontade para modificar e adaptar Ã s necessidades do seu laboratÃ³rio ou empresa.

